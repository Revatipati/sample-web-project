pipeline {
    agent any // selection of agents 
    // defining environment variables 
    environment {
        REPO_NAME  = 'https://github.com/Revatipati/sample-web-project.git'
        BRANCH_NAME = 'master'
        SONAR_TOKEN = credentials('rp-day3- sonar-token')
      //  SONAR_HOME = 'C:\\Users\\Administrator\\Documents\\tools\\sonar-scanner\\bin'

    }
    stages {
        // stage1
        stage('testing and verify of required  commands') {
            steps {                
                echo 'checking sonar version'
                bat 'sonar-scanner --version'
                echo 'checking java version'
                bat 'docker version'
                echo 'chekcing java version'
                bat 'java -version'
            }
        }

        stage('clone') {
            steps {
                echo 'clone repo to project'
                git url: "${REPO_NAME}", branch: "${BRANCH_NAME}"
            }
        }

        stage('SAST') {
            steps {
                echo 'sast with sonar scanner'
                bat """
                 sonar-scanner \
                -Dsonar.projectKey=RPProjDay3 \
                -Dsonar.sources=. \
                -Dsonar.host.url=http://13.203.151.240:9000 \
                -Dsonar.token=${SONAR_TOKEN}
                """
            }
        }
     
    }
}